import numpy as np
from climada.entity import ImpactFunc, ImpactFuncSet

# =============================================================================
# Conversion from PAGER building classification to Flood impact category
# from https://nhess.copernicus.org/articles/19/1703/2019/
# =============================================================================

DICT_PAGER_FLIMPF = {
    'A': 1,  # added manually, corresponds to ADB
    'ADB': 1,
    'ERTH': 1,
    'INF': 1,
    'M': 1,
    'RE': 1,
    'WWD': 1,
    'W1': 2,  # added manually, was not available in paper
    'W2': 2,
    'WLI': 2,
    'WS': 2,
    'BRK': 3,
    'CB': 3,
    'DS': 3,
    'STN': 3,
    'RS1': 2,  # added manually, was not available in paper
    'RS2': 3,  # added manually, was not available in paper
    'RS3': 3,  # added manually, was not available in paper
    'RS4': 3,  # added manually, was not available in paper
    'UCB': 4,
    'UFB': 4,
    'BTLR': 4,
    'C': 4,  # added manually, corresponds to any C-X
    'C2': 4,
    'C3': 4,
    'MCF': 4,
    'RC': 4,
    'RM': 4,
    'S': 4}

# =============================================================================
# Bulding-type wise Flood impact functions
# from https://nhess.copernicus.org/articles/19/1703/2019/
# =============================================================================

impf_fl_I = ImpactFunc(
    id=1,
    name='Flood impact function class I',
    intensity_unit='metres',
    haz_type='FL',
    intensity=np.linspace(0, 5, num=11),
    mdd=np.linspace(1, 1, num=11),
    paa=np.array([0, 0.5, 0.9, 1, 1, 1, 1, 1, 1, 1, 1]),
)

impf_fl_II = ImpactFunc(
    id=2,
    name='Flood impact function class II',
    intensity_unit='metres',
    haz_type='FL',
    intensity=np.linspace(0, 5, num=11),
    mdd=np.linspace(1, 1, num=11),
    paa=np.array([0, 0.45, 0.7, 0.85, 0.95, 1, 1, 1, 1, 1, 1]),
)


impf_fl_IIIa = ImpactFunc(
    id=3,
    name='Flood impact function class III - one storey',
    intensity_unit='metres',
    haz_type='FL',
    intensity=np.linspace(0, 5, num=11),
    mdd=np.linspace(1, 1, num=11),
    paa=np.array([0, 0.4, 0.55, 0.7, 0.78, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8]),
)

impf_fl_IIIb = ImpactFunc(
    id=3.2,
    name='Flood impact function class III - two storeys',
    intensity_unit='metres',
    haz_type='FL',
    intensity=np.linspace(0, 5, num=11),
    mdd=np.linspace(1, 1, num=11),
    paa=np.array([0, 0.25, 0.4, 0.5, 0.58, 0.65, 0.7, 0.75, 0.78, 0.8, 0.8]),
)

impf_fl_IVa = ImpactFunc(
    id=4,
    name='Flood impact function class IV - one storey',
    intensity_unit='metres',
    haz_type='FL',
    intensity=np.linspace(0, 5, num=11),
    mdd=np.linspace(1, 1, num=11),
    paa=np.array([0, 0.35, 0.45, 0.55, 0.62, 0.65,
                 0.65, 0.65, 0.65, 0.65, 0.65]),
)


impf_fl_IVb = ImpactFunc(
    id=4.2,
    name='Flood impact function class IV - two storeys',
    intensity_unit='metres',
    haz_type='FL',
    intensity=np.linspace(0, 5, num=11),
    mdd=np.linspace(1, 1, num=11),
    paa=np.array([0, 0.2, 0.3, 0.4, 0.45, 0.5, 0.55, 0.6, 0.63, 0.65, 0.65]),
)

impf_set_fl = ImpactFuncSet([impf_fl_I, impf_fl_II, impf_fl_IIIa,
                             impf_fl_IIIb, impf_fl_IVa, impf_fl_IVb])
